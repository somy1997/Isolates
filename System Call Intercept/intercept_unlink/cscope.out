cscope 15 $HOME/Desktop/intercept_unlink               0000003895
	@intercept_unlink.c

1 
	~<löux/moduÀ.h
>

2 
	~<löux/kî√l.h
>

3 
	~<löux/öô.h
>

4 
	~<löux/sysˇŒs.h
>

5 
	~<löux/uni°d.h
>

8 
MODULE_LICENSE
 ("GPL");

10 *
	gsys_ˇŒ_èbÀ
;

12 
asmlökage
 (*
‹igöÆ_sys_u∆ök
Ë(c⁄° *
∑th«me
);

15 
asmlökage
 
	$hacked_sys_u∆ök
(c⁄° *
∑th«me
)

18 
	}
}

20 
__öô
 
	$my_öô
 ()

22 
	`¥ötk
(
KERN_ALERT
 "Entered my_init\n");

25 
sys_ˇŒ_èbÀ
=0xffffffff81e001e0;

26 
sys_ˇŒ_èbÀ
=0x81e001e0;

28 
	`¥ötk
(
KERN_ALERT
 "AssignedáddressÅo sys_call_table, calling xchgÇow\n");

31 
‹igöÆ_sys_u∆ök
 =(* )
	`xchg
(&
sys_ˇŒ_èbÀ
[
__NR_u∆ök
],

32 
hacked_sys_u∆ök
);

33 
	`¥ötk
(
KERN_ALERT
 "xchg called successfully, original sys unlink swapped with hacked sys unlink\n");

35 
	}
}

37 
	$my_exô
 ()

40 
	`¥ötk
(
KERN_ALERT
 "Entered my_exit\n");

41 
	`xchg
(&
sys_ˇŒ_èbÀ
[
__NR_u∆ök
], 
‹igöÆ_sys_u∆ök
);

42 
	`¥ötk
(
KERN_ALERT
 "xchg called successfully, original sys unlinkÑestored\n");

43 
	}
}

45 
moduÀ_öô
(
my_öô
);

46 
moduÀ_exô
(
my_exô
);

	@intercept_unlink.mod.c

1 
	~<löux/moduÀ.h
>

2 
	~<löux/vîmagic.h
>

3 
	~<löux/compûî.h
>

5 
MODULE_INFO
(
vîmagic
, 
VERMAGIC_STRING
);

6 
MODULE_INFO
(
«me
, 
KBUILD_MODNAME
);

8 
__visibÀ
 
moduÀ
 
__this_moduÀ


9 
__©åibuã__
((
£˘i⁄
(".gnu.linkonce.this_module"))) = {

10 .
«me
 = 
KBUILD_MODNAME
,

11 .
	göô
 = 
öô_moduÀ
,

12 #ifde‡
CONFIG_MODULE_UNLOAD


13 .
	gexô
 = 
˛ónup_moduÀ
,

15 .
	g¨ch
 = 
MODULE_ARCH_INIT
,

18 #ifde‡
RETPOLINE


19 
MODULE_INFO
(
ªçﬁöe
, "Y");

22 c⁄° 
	g__moduÀ_dïíds
[]

23 
__u£d


24 
__©åibuã__
((
£˘i⁄
(".modinfo"))) =

28 
MODULE_INFO
(
§cvîsi⁄
, "2CA6D1C95DF04CF167EA9F6");

	@/usr/include/linux/kernel.h

1 #i‚de‡
_LINUX_KERNEL_H


2 
	#_LINUX_KERNEL_H


	)

4 
	~<löux/sysöfo.h
>

9 
	#__ALIGN_KERNEL
(
x
, 
a
Ë
	`__ALIGN_KERNEL_MASK
(x, (
	`ty≥of
(x))◊Ë- 1)

	)

10 
	#__ALIGN_KERNEL_MASK
(
x
, 
mask
Ë(((xË+ (mask)Ë& ~(mask))

	)

	@/usr/include/linux/unistd.h

1 #i‚de‡
_LINUX_UNISTD_H_


2 
	#_LINUX_UNISTD_H_


	)

7 
	~<asm/uni°d.h
>

	@/usr/include/linux/sysinfo.h

1 #i‚de‡
_LINUX_SYSINFO_H


2 
	#_LINUX_SYSINFO_H


	)

4 
	~<löux/ty≥s.h
>

6 
	#SI_LOAD_SHIFT
 16

	)

7 
	ssysöfo
 {

8 
__kî√l_l⁄g_t
 
	mu±ime
;

9 
__kî√l_ul⁄g_t
 
	mlﬂds
[3];

10 
__kî√l_ul⁄g_t
 
	mtŸÆøm
;

11 
__kî√l_ul⁄g_t
 
	m‰ìøm
;

12 
__kî√l_ul⁄g_t
 
	msh¨edøm
;

13 
__kî√l_ul⁄g_t
 
	mbuf„ºam
;

14 
__kî√l_ul⁄g_t
 
	mtŸÆsw≠
;

15 
__kî√l_ul⁄g_t
 
	m‰ìsw≠
;

16 
__u16
 
	m¥ocs
;

17 
__u16
 
	m∑d
;

18 
__kî√l_ul⁄g_t
 
	mtŸÆhigh
;

19 
__kî√l_ul⁄g_t
 
	m‰ìhigh
;

20 
__u32
 
	mmem_unô
;

21 
	m_f
[20-2*(
__kî√l_ul⁄g_t
)-(
__u32
)];

	@/usr/include/linux/types.h

1 #i‚de‡
_LINUX_TYPES_H


2 
	#_LINUX_TYPES_H


	)

4 
	~<asm/ty≥s.h
>

6 #i‚de‡
__ASSEMBLY__


8 
	~<löux/posix_ty≥s.h
>

16 #ifde‡
__CHECKER__


17 
	#__bôwi£__
 
	`__©åibuã__
((
bôwi£
))

	)

19 
	#__bôwi£__


	)

21 #ifde‡
__CHECK_ENDIAN__


22 
	#__bôwi£
 
__bôwi£__


	)

24 
	#__bôwi£


	)

27 
__u16
 
	t__bôwi£
 
	t__À16
;

28 
__u16
 
	t__bôwi£
 
	t__be16
;

29 
__u32
 
	t__bôwi£
 
	t__À32
;

30 
__u32
 
	t__bôwi£
 
	t__be32
;

31 
__u64
 
	t__bôwi£
 
	t__À64
;

32 
__u64
 
	t__bôwi£
 
	t__be64
;

34 
__u16
 
	t__bôwi£
 
	t__sum16
;

35 
__u32
 
	t__bôwi£
 
	t__wsum
;

46 
	#__Æig√d_u64
 
__u64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

47 
	#__Æig√d_be64
 
__be64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

48 
	#__Æig√d_À64
 
__À64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

	@/usr/include/linux/posix_types.h

1 #i‚de‡
_LINUX_POSIX_TYPES_H


2 
	#_LINUX_POSIX_TYPES_H


	)

4 
	~<löux/°ddef.h
>

21 #unde‡
__FD_SETSIZE


22 
	#__FD_SETSIZE
 1024

	)

25 
	mfds_bôs
[
__FD_SETSIZE
 / (8 * ())];

26 } 
	t__kî√l_fd_£t
;

29 (*
	t__kî√l_sigh™dÀr_t
)();

32 
	t__kî√l_key_t
;

33 
	t__kî√l_mqd_t
;

35 
	~<asm/posix_ty≥s.h
>

	@/usr/include/linux/stddef.h

	@
1
.
1
/usr/include
8
215
intercept_unlink.c
intercept_unlink.mod.c
/usr/include/linux/kernel.h
/usr/include/linux/unistd.h
/usr/include/linux/sysinfo.h
/usr/include/linux/types.h
/usr/include/linux/posix_types.h
/usr/include/linux/stddef.h
