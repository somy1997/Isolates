cscope 15 $HOME/Desktop/intercept_sof               0000003493
	@intercept_sof.c

1 
	~<lšux/moduË.h
>

2 
	~<lšux/k®lsyms.h
>

3 
	~<lšux/k”Ãl.h
>

4 
	~<lšux/š™.h
>

5 
	~<lšux/sysÿÎs.h
>

6 
	~<lšux/uni¡d.h
>

9 
MODULE_LICENSE
("GPL");

10 *
	gsym_Çme
 = "sys_call_table";

12 
asmlškage
 (*
	tsys_ÿÎ_±r_t
)(cÚ¡ 
	t±_»gs
 *);

13 
sys_ÿÎ_±r_t
 *
sys_ÿÎ_bË
;

14 
asmlškage
 (*
	tcu¡om_İ’
è(cÚ¡ 
	t__u£r
 *
	tf’ame
, 
	tæags
, 
	tumode_t
 
	tmode
);

16 
cu¡om_İ’
 
Şd_İ’
;

18 
asmlškage
 
	$my_İ’
(cÚ¡ 
__u£r
 *
f’ame
, 
æags
, 
umode_t
 
mode
)

20 
	`´štk
(
KERN_ALERT
 "open function called\n");

22  
	`Şd_İ’
(
f’ame
, 
æags
, 
mode
);

23 
	}
}

25 
__š™
 
	$h–lo_š™
()

28 
	`´štk
(
KERN_ALERT
 "Entered my_init\n");

31 
sys_ÿÎ_bË
 = (
sys_ÿÎ_±r_t
 *)
	`k®lsyms_lookup_Çme
(
sym_Çme
);

32 
Şd_İ’
 = (
cu¡om_İ’
)
sys_ÿÎ_bË
[
__NR_İ’
];

35 
	`wr™e_ü0
(
	`»ad_ü0
() & (~0x10000));

38 
sys_ÿÎ_bË
[
__NR_İ’
] = (
sys_ÿÎ_±r_t
)
my_İ’
;

41 
	`wr™e_ü0
(
	`»ad_ü0
() | 0x10000);

44 
	}
}

46 
__ex™
 
	$h–lo_ex™
()

48 
	`´štk
(
KERN_ALERT
 "Entered my_exit\n");

51 
	`wr™e_ü0
(
	`»ad_ü0
() & (~0x10000));

54 
sys_ÿÎ_bË
[
__NR_İ’
] = (
sys_ÿÎ_±r_t
)
Şd_İ’
;

57 
	`wr™e_ü0
(
	`»ad_ü0
() | 0x10000);

59 
	}
}

61 
moduË_š™
(
h–lo_š™
);

62 
moduË_ex™
(
h–lo_ex™
);

	@/usr/include/linux/kernel.h

1 #iâdeà
_LINUX_KERNEL_H


2 
	#_LINUX_KERNEL_H


	)

4 
	~<lšux/sysšfo.h
>

9 
	#__ALIGN_KERNEL
(
x
, 
a
è
	`__ALIGN_KERNEL_MASK
(x, (
	`ty³of
(x))×è- 1)

	)

10 
	#__ALIGN_KERNEL_MASK
(
x
, 
mask
è(((xè+ (mask)è& ~(mask))

	)

	@/usr/include/linux/unistd.h

1 #iâdeà
_LINUX_UNISTD_H_


2 
	#_LINUX_UNISTD_H_


	)

7 
	~<asm/uni¡d.h
>

	@/usr/include/linux/sysinfo.h

1 #iâdeà
_LINUX_SYSINFO_H


2 
	#_LINUX_SYSINFO_H


	)

4 
	~<lšux/ty³s.h
>

6 
	#SI_LOAD_SHIFT
 16

	)

7 
	ssysšfo
 {

8 
__k”Ãl_lÚg_t
 
	mu±ime
;

9 
__k”Ãl_ulÚg_t
 
	mlßds
[3];

10 
__k”Ãl_ulÚg_t
 
	mtÙ®¿m
;

11 
__k”Ãl_ulÚg_t
 
	mä“¿m
;

12 
__k”Ãl_ulÚg_t
 
	msh¬ed¿m
;

13 
__k”Ãl_ulÚg_t
 
	mbufã¼am
;

14 
__k”Ãl_ulÚg_t
 
	mtÙ®sw­
;

15 
__k”Ãl_ulÚg_t
 
	mä“sw­
;

16 
__u16
 
	m´ocs
;

17 
__u16
 
	m·d
;

18 
__k”Ãl_ulÚg_t
 
	mtÙ®high
;

19 
__k”Ãl_ulÚg_t
 
	mä“high
;

20 
__u32
 
	mmem_un™
;

21 
	m_f
[20-2*(
__k”Ãl_ulÚg_t
)-(
__u32
)];

	@/usr/include/linux/types.h

1 #iâdeà
_LINUX_TYPES_H


2 
	#_LINUX_TYPES_H


	)

4 
	~<asm/ty³s.h
>

6 #iâdeà
__ASSEMBLY__


8 
	~<lšux/posix_ty³s.h
>

16 #ifdeà
__CHECKER__


17 
	#__b™wi£__
 
	`__©Œibu‹__
((
b™wi£
))

	)

19 
	#__b™wi£__


	)

21 #ifdeà
__CHECK_ENDIAN__


22 
	#__b™wi£
 
__b™wi£__


	)

24 
	#__b™wi£


	)

27 
__u16
 
	t__b™wi£
 
	t__Ë16
;

28 
__u16
 
	t__b™wi£
 
	t__be16
;

29 
__u32
 
	t__b™wi£
 
	t__Ë32
;

30 
__u32
 
	t__b™wi£
 
	t__be32
;

31 
__u64
 
	t__b™wi£
 
	t__Ë64
;

32 
__u64
 
	t__b™wi£
 
	t__be64
;

34 
__u16
 
	t__b™wi£
 
	t__sum16
;

35 
__u32
 
	t__b™wi£
 
	t__wsum
;

46 
	#__®igÃd_u64
 
__u64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

47 
	#__®igÃd_be64
 
__be64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

48 
	#__®igÃd_Ë64
 
__Ë64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

	@/usr/include/linux/posix_types.h

1 #iâdeà
_LINUX_POSIX_TYPES_H


2 
	#_LINUX_POSIX_TYPES_H


	)

4 
	~<lšux/¡ddef.h
>

21 #undeà
__FD_SETSIZE


22 
	#__FD_SETSIZE
 1024

	)

25 
	mfds_b™s
[
__FD_SETSIZE
 / (8 * ())];

26 } 
	t__k”Ãl_fd_£t
;

29 (*
	t__k”Ãl_sighªdËr_t
)();

32 
	t__k”Ãl_key_t
;

33 
	t__k”Ãl_mqd_t
;

35 
	~<asm/posix_ty³s.h
>

	@/usr/include/linux/stddef.h

	@
1
.
1
/usr/include
7
189
intercept_sof.c
/usr/include/linux/kernel.h
/usr/include/linux/unistd.h
/usr/include/linux/sysinfo.h
/usr/include/linux/types.h
/usr/include/linux/posix_types.h
/usr/include/linux/stddef.h
